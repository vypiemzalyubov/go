## Руководство по работе с Makefile

Данный Makefile был любезно взять из статьи [Go, я создал: пишем тесты на Allure-Go](https://habr.com/ru/companies/ozontech/articles/677690/), который лежал в репозитории [habr_example_july](https://github.com/koodeex/habr_example_july/tree/master) и с любовью переработан :blush:.

<div id="header" align="center">
  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/%D0%AD%D1%82%D0%BE_%D0%BD%D0%B5%D0%BC%D0%BD%D0%BE%D0%B3%D0%BE%2C_%D0%BD%D0%BE_%D1%8D%D1%82%D0%BE_%D1%87%D0%B5%D1%81%D1%82%D0%BD%D0%B0%D1%8F_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0.jpg/1200px-%D0%AD%D1%82%D0%BE_%D0%BD%D0%B5%D0%BC%D0%BD%D0%BE%D0%B3%D0%BE%2C_%D0%BD%D0%BE_%D1%8D%D1%82%D0%BE_%D1%87%D0%B5%D1%81%D1%82%D0%BD%D0%B0%D1%8F_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0.jpg" width="500"/>
</div>

## Содержание

- [Руководство по работе с Makefile](#руководство-по-работе-с-makefile)
- [Содержание](#содержание)
- [Предварительные требования](#предварительные-требования)
- [Установка](#установка)
  - [Установка зависимостей](#установка-зависимостей)
  - [Полная установка](#полная-установка)
  - [Установка Allure](#установка-allure)
- [Команды Makefile](#команды-makefile)
  - [install](#install)
  - [install-full](#install-full)
  - [clean](#clean)
  - [test](#test)
  - [allure-serve](#allure-serve)
  - [e2e-tests](#e2e-tests)

## Предварительные требования

Перед началом работы убедитесь, что у вас установлены следующие инструменты:

- Go (для запуска тестов и работы с проектом на языке Golang)
- Менеджер пакетов:
  - **Windows**: `scoop`
  - **Linux**: доступ к `apt-get` и права `sudo`
  - **macOS**: `brew`

Также для генерации отчетов о тестах требуется установка Allure.

## Установка

### Установка зависимостей

Для установки всех необходимых Go-зависимостей выполните следующую команду:

```bash
make install
```

### Полная установка
Эта команда не только установит Go-зависимости, но и установит Allure в зависимости от операционной системы, на которой вы работаете:

```bash
make install-full
```

### Установка Allure
Команда `install-full` автоматически распознает вашу операционную систему и выполнит установку Allure:
- **Windows**: Убедитесь, что у вас установлен менеджер пакетов scoop. Инструкции по установке можно найти [здесь](https://github.com/ScoopInstaller/Scoop#installation).
- **Linux**: Вам потребуются права `sudo`. Установка будет выполнена с использованием команды `apt-get`.
- **macOS**: Для установки используется пакетный менеджер brew. Убедитесь, что он установлен. Подробности по установке можно найти [здесь](https://docs.brew.sh/Installation).

## Команды Makefile

### install
Эта команда устанавливает все зависимости проекта, указанные в go.mod. Она полезна, если вы только что клонировали проект и хотите установить все необходимые пакеты:
```bash
make install
```

### install-full
Команда `install-full` сначала устанавливает все Go-зависимости, а затем устанавливает Allure на вашем компьютере в зависимости от операционной системы:
```bash
make install-full
```

### clean
Очищает директорию с результатами отчетов Allure. Используйте эту команду перед запуском новых тестов для удаления старых результатов:
```bash
make clean
```

### test
Запускает все тесты проекта, находящиеся в директории grpc_tests, и сохраняет результаты тестов в директории Allure. Если тесты не пройдут, команда продолжит выполнение, не завершаясь с ошибкой:
```bash
make test
```

### allure-serve
Эта команда запускает локальный сервер для просмотра отчетов Allure. После запуска в браузере откроется интерфейс, где можно просматривать результаты тестов:
```bash
make allure-serve
```

<div id="header" align="center">
  <img src="https://i.postimg.cc/fyHTjbfN/2024-09-21-15-01-00.png" width="1000"/>
</div>

### e2e-tests
Команда `e2e-tests` последовательно выполняет следующие шаги:
- Очищает директорию с результатами тестов (`make clean`).
- Запускает тесты и сохраняет результаты (`make test`).
- Запускает сервер Allure для просмотра отчетов (`make allure-serve`).

Используется для полного цикла тестирования с автоматической генерацией отчетов:
```bash
make e2e-tests
```

<div id="header" align="center">
  <img src="https://i.pinimg.com/736x/96/2a/f5/962af588e16c9e32190d4b629698e52f.jpg" width="500"/>
</div>